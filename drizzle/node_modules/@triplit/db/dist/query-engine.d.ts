import { DBEntity, EntityStore, KVStoreOrTransaction, PreparedQuery, PreparedOrder } from './types.js';
export interface ViewEntity {
    data: DBEntity;
    subqueries: Record<string, null | ViewEntity[] | ViewEntity>;
}
export declare function createViewEntity(ent: DBEntity): ViewEntity;
export declare function flattenViewEntity(viewEnt: ViewEntity | null): any;
export declare function flattenViews(views: Record<string, ViewEntity[] | ViewEntity>): {
    [k: string]: any;
};
export declare class EntityStoreQueryEngine {
    private storage;
    private store;
    constructor(storage: KVStoreOrTransaction, store: EntityStore);
    /**
     * A top-level fetch method that compiles a query and executes it.
     */
    fetch(query: PreparedQuery, vars?: any): Promise<ViewEntity[]>;
    private executeSteps;
    getCollectionCandidates(query: PreparedQuery): AsyncIterable<ViewEntity>;
    getCollectionCandidatesById(collectionName: string, ids: string[] | Set<string>): AsyncIterable<ViewEntity>;
}
export declare function sortViewEntities(entities: ViewEntity[], order: PreparedOrder): void;
