import { DB, DBSchema } from './db.js';
import { Models, SessionRole } from './schema/index.js';
export interface Session {
    vars: Record<string, any>;
    roles: SessionRole[];
}
export declare class DBSession implements Session {
    readonly vars: Record<string, any>;
    readonly db: DB<any>;
    private _roles;
    constructor(db: DB<any>, vars: Record<string, any>);
    get roles(): SessionRole[];
}
export declare function createSession<T extends DB<any>>(db: T, vars: Record<string, any>): T;
/**
 * Parse a token and return the roles that match the token
 * return undefined to indicate no permissions defined (so can skip)
 * return [] to indicate no roles match the token
 */
export declare function getRolesFromSession<M extends Models<M>, S extends DBSchema<M>>(schema: S | undefined, token: Record<string, any>): SessionRole[] | undefined;
export declare function sessionRolesAreEquivalent(a: SessionRole[] | undefined, b: SessionRole[] | undefined): boolean;
export declare function normalizeSessionVars(variables: Record<string, any>): Record<string, any>;
