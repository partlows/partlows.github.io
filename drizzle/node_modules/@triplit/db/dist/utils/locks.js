export class Mutex {
    #lockReleasePromise = null;
    async acquireLock() {
        if (this.#lockReleasePromise) {
            await this.#lockReleasePromise;
        }
        const { resolve, reject, promise } = Promise.withResolvers();
        this.#lockReleasePromise = promise;
        return {
            [Symbol.dispose]: () => {
                this.#lockReleasePromise = null;
                resolve();
            },
        };
    }
}
//# sourceMappingURL=locks.js.map