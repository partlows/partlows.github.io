{"version":3,"file":"fieldsTypeTest.js","sourceRoot":"","sources":["../../../src/__types__/fieldsTypeTest.ts"],"names":[],"mappings":"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","sourcesContent":["import { i, init } from '../index.ts';\nimport type { Equal, Expect, NotAny } from './typeUtils.ts';\n\n// These tests just check types. See `type _cases = ` for the test cases.\n\nconst schema = i.schema({\n  entities: {\n    tbl: i.entity({\n      a: i.number(),\n      b: i.string(),\n    }),\n  },\n});\n\n// Test that fields works with a schema\nfunction _testFieldsWithSchema() {\n  const schemaDb = init({\n    schema: schema,\n    appId: '123',\n  });\n  schemaDb.subscribeQuery({ tbl: { $: { fields: ['a'] } } }, (resp) => {\n    const item = resp.data?.tbl[0];\n    if (item) {\n      type t = typeof item;\n      type _cases = [\n        Expect<NotAny<t>>,\n        Expect<Equal<t, { id: string; a: number }>>,\n      ];\n    }\n  });\n  schemaDb.subscribeQuery({ tbl: { $: { fields: ['id', 'a'] } } }, (resp) => {\n    const item = resp.data?.tbl[0];\n    if (item) {\n      type t = typeof item;\n      type _cases = [\n        Expect<NotAny<t>>,\n        Expect<Equal<t, { id: string; a: number }>>,\n      ];\n    }\n  });\n  schemaDb.subscribeQuery({ tbl: { $: { fields: undefined } } }, (resp) => {\n    const item = resp.data?.tbl[0];\n    if (item) {\n      type t = typeof item;\n      type _cases = [\n        Expect<NotAny<t>>,\n        Expect<Equal<t, { id: string; a: number; b: string }>>,\n      ];\n    }\n  });\n  schemaDb.subscribeQuery({ tbl: {} }, (resp) => {\n    const item = resp.data?.tbl[0];\n    if (item) {\n      type t = typeof item;\n      type _cases = [\n        Expect<NotAny<t>>,\n        Expect<Equal<t, { id: string; a: number; b: string }>>,\n      ];\n    }\n  });\n}\n\n// Test that fields does nothing when there is no schema\nfunction _testFieldsNoSchema() {\n  const noSchemaDb = init({\n    appId: '123',\n  });\n\n  noSchemaDb.subscribeQuery({ tbl: { $: { fields: ['a'] } } }, (resp) => {\n    const item = resp.data?.tbl[0];\n    if (item) {\n      type t = typeof item;\n      type _cases = [\n        Expect<NotAny<t>>,\n        Expect<Equal<t, { id: string; [x: string]: any }>>,\n      ];\n    }\n  });\n\n  noSchemaDb.subscribeQuery({ tbl: { $: { fields: ['id', 'a'] } } }, (resp) => {\n    const item = resp.data?.tbl[0];\n    if (item) {\n      type t = typeof item;\n      type _cases = [\n        Expect<NotAny<t>>,\n        Expect<Equal<t, { id: string; [x: string]: any }>>,\n      ];\n    }\n  });\n\n  noSchemaDb.subscribeQuery({ tbl: { $: { fields: undefined } } }, (resp) => {\n    const item = resp.data?.tbl[0];\n    if (item) {\n      type t = typeof item;\n      type _cases = [\n        Expect<NotAny<t>>,\n        Expect<Equal<t, { id: string; [x: string]: any }>>,\n      ];\n    }\n  });\n  noSchemaDb.subscribeQuery({ tbl: {} }, (resp) => {\n    const item = resp.data?.tbl[0];\n    if (item) {\n      type t = typeof item;\n      type _cases = [\n        Expect<NotAny<t>>,\n        Expect<Equal<t, { id: string; [x: string]: any }>>,\n      ];\n    }\n  });\n}\n"]}