{"version":3,"file":"authAPI.js","sourceRoot":"","sources":["../../src/authAPI.ts"],"names":[],"mappings":"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","sourcesContent":["import { User } from './clientTypes.ts';\nimport { jsonFetch } from './utils/fetch.js';\n\ntype SharedInput = {\n  apiURI: string;\n  appId: string;\n};\n\nexport type SendMagicCodeParams = { email: string };\nexport type SendMagicCodeResponse = {\n  sent: true;\n};\n\nexport function sendMagicCode({\n  apiURI,\n  appId,\n  email,\n}: SharedInput & SendMagicCodeParams): Promise<SendMagicCodeResponse> {\n  return jsonFetch(`${apiURI}/runtime/auth/send_magic_code`, {\n    method: 'POST',\n    headers: { 'content-type': 'application/json' },\n    body: JSON.stringify({ 'app-id': appId, email }),\n  });\n}\n\nexport type VerifyMagicCodeParams = {\n  email: string;\n  code: string;\n  refreshToken?: string | undefined;\n};\nexport type VerifyResponse = {\n  user: User;\n};\nexport async function verifyMagicCode({\n  apiURI,\n  appId,\n  email,\n  code,\n  refreshToken,\n}: SharedInput & VerifyMagicCodeParams): Promise<VerifyResponse> {\n  const res = await jsonFetch(`${apiURI}/runtime/auth/verify_magic_code`, {\n    method: 'POST',\n    headers: { 'content-type': 'application/json' },\n    body: JSON.stringify({\n      'app-id': appId,\n      email,\n      code,\n      ...(refreshToken ? { 'refresh-token': refreshToken } : {}),\n    }),\n  });\n  return res;\n}\n\nexport type VerifyRefreshTokenParams = { refreshToken: string };\nexport async function verifyRefreshToken({\n  apiURI,\n  appId,\n  refreshToken,\n}: SharedInput & VerifyRefreshTokenParams): Promise<VerifyResponse> {\n  const res = await jsonFetch(`${apiURI}/runtime/auth/verify_refresh_token`, {\n    method: 'POST',\n    headers: { 'content-type': 'application/json' },\n    body: JSON.stringify({\n      'app-id': appId,\n      'refresh-token': refreshToken,\n    }),\n  });\n  return res;\n}\n\nexport async function signInAsGuest({\n  apiURI,\n  appId,\n}: SharedInput): Promise<VerifyResponse> {\n  const res = await jsonFetch(`${apiURI}/runtime/auth/sign_in_guest`, {\n    method: 'POST',\n    headers: { 'content-type': 'application/json' },\n    body: JSON.stringify({\n      'app-id': appId,\n    }),\n  });\n  return res;\n}\n\nexport type ExchangeCodeForTokenParams = {\n  code: string;\n  codeVerifier?: string;\n  refreshToken?: string | undefined;\n};\n\nexport async function exchangeCodeForToken({\n  apiURI,\n  appId,\n  code,\n  codeVerifier,\n  refreshToken,\n}: SharedInput & ExchangeCodeForTokenParams): Promise<VerifyResponse> {\n  const res = await jsonFetch(`${apiURI}/runtime/oauth/token`, {\n    method: 'POST',\n    headers: { 'content-type': 'application/json' },\n    body: JSON.stringify({\n      app_id: appId,\n      code: code,\n      code_verifier: codeVerifier,\n      refresh_token: refreshToken,\n    }),\n  });\n  return res;\n}\n\nexport type SignInWithIdTokenParams = {\n  nonce?: string | null | undefined;\n  idToken: string;\n  clientName: string;\n  refreshToken?: string;\n};\n\nexport async function signInWithIdToken({\n  apiURI,\n  appId,\n  nonce,\n  idToken,\n  clientName,\n  refreshToken,\n}: SharedInput & SignInWithIdTokenParams): Promise<VerifyResponse> {\n  const res = await jsonFetch(`${apiURI}/runtime/oauth/id_token`, {\n    method: 'POST',\n    headers: { 'content-type': 'application/json' },\n    body: JSON.stringify({\n      app_id: appId,\n      nonce,\n      id_token: idToken,\n      client_name: clientName,\n      refresh_token: refreshToken,\n    }),\n  });\n  return res;\n}\n\nexport type SignoutParams = { refreshToken: string };\nexport async function signOut({\n  apiURI,\n  appId,\n  refreshToken,\n}: SharedInput & SignoutParams): Promise<{}> {\n  const res = await jsonFetch(`${apiURI}/runtime/signout`, {\n    method: 'POST',\n    headers: {\n      'content-type': 'application/json',\n    },\n    body: JSON.stringify({\n      app_id: appId,\n      refresh_token: refreshToken,\n    }),\n  });\n  return res;\n}\n"]}